<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.7"/>
<title>PRAgMaTIc: python/ellipse_convergence.py File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">PRAgMaTIc
   &#160;<span id="projectnumber">master</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.7 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_7837fde3ab9c1fb2fc5be7b717af8d79.html">python</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#namespaces">Namespaces</a> &#124;
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">ellipse_convergence.py File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p><a href="ellipse__convergence_8py_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="namespaces"></a>
Namespaces</h2></td></tr>
<tr class="memitem:namespaceellipse__convergence"><td class="memItemLeft" align="right" valign="top"> &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceellipse__convergence.html">ellipse_convergence</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ac96bfefe654f3d9302ebe19e430a8507"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceellipse__convergence.html#ac96bfefe654f3d9302ebe19e430a8507">ellipse_convergence.ellipse_convergence</a></td></tr>
<tr class="separator:ac96bfefe654f3d9302ebe19e430a8507"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad43ea591e00e42423b49176e7e41e47f"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceellipse__convergence.html#ad43ea591e00e42423b49176e7e41e47f">ellipse_convergence.boundary</a></td></tr>
<tr class="separator:ad43ea591e00e42423b49176e7e41e47f"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:a28466f5c5288ee84b4143a7ca4c0f7eb"><td class="memItemLeft" align="right" valign="top">tuple&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceellipse__convergence.html#a28466f5c5288ee84b4143a7ca4c0f7eb">ellipse_convergence.ddtestsol</a> = ddtestsol.replace('a**2','(a*a)')</td></tr>
<tr class="memdesc:a28466f5c5288ee84b4143a7ca4c0f7eb"><td class="mdescLeft">&#160;</td><td class="mdescRight">testsol = '(0.25-ww/2&lt;sqrt(x[0]*x[0]+x[1]*x[1]) &amp;&amp; sqrt(x[0]*x[0]+x[1]*x[1]) &lt; 0.25+ww/2 ? (' + stepfunc + ')) : (0.25&lt;sqrt(x[0]*x[0]+x[1]*x[1]) ? 1 : 0)' ddtestsol = '0.25-ww/2&lt;sqrt(x[0]*x[0]+x[1]*x[1]) &amp;&amp; sqrt(x[0]*x[0]+x[1]*x[1]) &lt; 0.25+ww/2 ? (' + ddstepfunc + ') : 0' else: # problem == 0: rrpy = pysqrt(sx*sx+sy*sy) #'if(t&lt;2*WeMax,0,if(t&lt;4*WeMax,0.5+3/2/(2*WeMax)*(t-3*WeMax)-2/(2*WeMax)^3*(t-3*WeMax)^3,1))'; %0.5+3/2/dx*(x-xc)-2/dx^3*(x-xc)^3 ddstepfunc = str(diff(stepfunc,sx,sx)+diff(stepfunc,sy,sy)).replace('sx','x[0]').replace('sy','x[1]').replace('x[0]**2','(x[0]*x[0])').replace('x[1]**2','(x[1]*x[1])') stepfunc = str(stepfunc).replace('sx','x[0]').replace('sy','x[1]').replace('x[0]**2','(x[0]*x[0])').replace('x[1]**2','(x[1]*x[1])') #REPLACE ** with pow ddstepfunc = ddstepfunc.replace('(sqrt(a*(x[1]*x[1]) + (x[0]*x[0])/a) - 0.25)**2','pow(sqrt(a*(x[1]*x[1]) + (x[0]*x[0])/a) - 0.25,2.)') ddstepfunc = ddstepfunc.replace('(a*(x[1]*x[1]) + (x[0]*x[0])/a)**(3/2)','pow(a*(x[1]*x[1]) + (x[0]*x[0])/a,1.5)') stepfunc = stepfunc.replace('(sqrt(a*(x[1]*x[1]) + (x[0]*x[0])/a) - 0.25)**3','pow(sqrt(a*(x[1]*x[1]) + (x[0]*x[0])/a) - 0.25,3.)') testsol = '0.25-ww/2&lt;sqrt(x[0]*x[0]+x[1]*x[1]) &amp;&amp; sqrt(x[0]*x[0]+x[1]*x[1]) &lt; 0.25+ww/2 ? (' + stepfunc + ') : (0.25&lt;sqrt(x[0]*x[0]+x[1]*x[1]) ? 1 : 0)' ddtestsol = '0.25-ww/2&lt;sqrt(x[0]*x[0]+x[1]*x[1]) &amp;&amp; sqrt(x[0]*x[0]+x[1]*x[1]) &lt; 0.25+ww/2 ? (' + ddstepfunc + ') : 0'  <a href="#a28466f5c5288ee84b4143a7ca4c0f7eb">More...</a><br /></td></tr>
<tr class="separator:a28466f5c5288ee84b4143a7ca4c0f7eb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa0c84016f521bbf3651d43ed5ab58d4b"><td class="memItemLeft" align="right" valign="top">tuple&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceellipse__convergence.html#aa0c84016f521bbf3651d43ed5ab58d4b">ellipse_convergence.testsol</a> = testsol.replace('ww**2','(ww*ww)')</td></tr>
<tr class="separator:aa0c84016f521bbf3651d43ed5ab58d4b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6ae2d640868905f171410b9356b1fd97"><td class="memItemLeft" align="right" valign="top">list&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceellipse__convergence.html#a6ae2d640868905f171410b9356b1fd97">ellipse_convergence.dofs</a> = []</td></tr>
<tr class="separator:a6ae2d640868905f171410b9356b1fd97"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad6467ddad2e6d8fc966c22f27894d0c2"><td class="memItemLeft" align="right" valign="top">list&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceellipse__convergence.html#ad6467ddad2e6d8fc966c22f27894d0c2">ellipse_convergence.L2errors</a> = []</td></tr>
<tr class="separator:ad6467ddad2e6d8fc966c22f27894d0c2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abf1752bef2543ac2d24aa961ab94f99d"><td class="memItemLeft" align="right" valign="top">tuple&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceellipse__convergence.html#abf1752bef2543ac2d24aa961ab94f99d">ellipse_convergence.meshsz</a> = int(round(80*0.005/(eta*(bool(use_adapt)==False)+0.05*(bool(use_adapt)==True))))</td></tr>
<tr class="memdesc:abf1752bef2543ac2d24aa961ab94f99d"><td class="mdescLeft">&#160;</td><td class="mdescRight">SETUP MESH.  <a href="#abf1752bef2543ac2d24aa961ab94f99d">More...</a><br /></td></tr>
<tr class="separator:abf1752bef2543ac2d24aa961ab94f99d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a27f272d6325454998304f422a72ae61b"><td class="memItemLeft" align="right" valign="top">tuple&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceellipse__convergence.html#a27f272d6325454998304f422a72ae61b">ellipse_convergence.mesh</a> = RectangleMesh(-0.0,-0.0,0.5*sqrt(asp),0.5/sqrt(asp),meshsz,meshsz,&quot;left/right&quot;)</td></tr>
<tr class="separator:a27f272d6325454998304f422a72ae61b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8e678865b1756256fde328538e6390e6"><td class="memItemLeft" align="right" valign="top">tuple&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceellipse__convergence.html#a8e678865b1756256fde328538e6390e6">ellipse_convergence.V</a> = FunctionSpace(mesh, &quot;CG&quot;, CGorder)</td></tr>
<tr class="separator:a8e678865b1756256fde328538e6390e6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a638db09c0cfe3013a2ae911d3f569ed4"><td class="memItemLeft" align="right" valign="top">tuple&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceellipse__convergence.html#a638db09c0cfe3013a2ae911d3f569ed4">ellipse_convergence.R</a> = Expression(ddtestsol)</td></tr>
<tr class="separator:a638db09c0cfe3013a2ae911d3f569ed4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab7e6654cfdd6bc311604775fa952d19b"><td class="memItemLeft" align="right" valign="top">tuple&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceellipse__convergence.html#ab7e6654cfdd6bc311604775fa952d19b">ellipse_convergence.a</a> = inner(grad(dis), grad(dus))</td></tr>
<tr class="separator:ab7e6654cfdd6bc311604775fa952d19b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a14828e8dee16e246aae925cadccb0808"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceellipse__convergence.html#a14828e8dee16e246aae925cadccb0808">ellipse_convergence.L</a> = R*dus*dx</td></tr>
<tr class="separator:a14828e8dee16e246aae925cadccb0808"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a997ccde25f9c562ec926e32be8579966"><td class="memItemLeft" align="right" valign="top">tuple&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceellipse__convergence.html#a997ccde25f9c562ec926e32be8579966">ellipse_convergence.bc</a> = DirichletBC(V, Expression(testsol), boundary)</td></tr>
<tr class="separator:a997ccde25f9c562ec926e32be8579966"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a51bb8af53c935ecaa90ca95805177caf"><td class="memItemLeft" align="right" valign="top">tuple&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceellipse__convergence.html#a51bb8af53c935ecaa90ca95805177caf">ellipse_convergence.H</a> = metric_pnorm(u, eta, max_edge_ratio=1+49*(use_adapt!=2), p=2)</td></tr>
<tr class="separator:a51bb8af53c935ecaa90ca95805177caf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acf9929f9d5d617589a9de6cd7ca2dd79"><td class="memItemLeft" align="right" valign="top">tuple&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceellipse__convergence.html#acf9929f9d5d617589a9de6cd7ca2dd79">ellipse_convergence.L2error</a> = errornorm(Expression(testsol), u, degree_rise=CGorder+2, norm_type='L2')</td></tr>
<tr class="separator:acf9929f9d5d617589a9de6cd7ca2dd79"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a43a4e4778e1a637cb9f054f9d64c8951"><td class="memItemLeft" align="right" valign="top">tuple&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceellipse__convergence.html#a43a4e4778e1a637cb9f054f9d64c8951">ellipse_convergence.testf</a> = interpolate(u ,FunctionSpace(mesh,'CG',1))</td></tr>
<tr class="separator:a43a4e4778e1a637cb9f054f9d64c8951"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7c7e24641f7c2bb15920c5cfd5d77639"><td class="memItemLeft" align="right" valign="top">tuple&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceellipse__convergence.html#a7c7e24641f7c2bb15920c5cfd5d77639">ellipse_convergence.testfe</a> = interpolate(Expression(testsol),FunctionSpace(mesh,'CG',1))</td></tr>
<tr class="separator:a7c7e24641f7c2bb15920c5cfd5d77639"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5ccf38dfbeefac7e923ad12000683d24"><td class="memItemLeft" align="right" valign="top">tuple&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceellipse__convergence.html#a5ccf38dfbeefac7e923ad12000683d24">ellipse_convergence.vtx2dof</a> = vertex_to_dof_map(FunctionSpace(mesh, &quot;CG&quot; ,1))</td></tr>
<tr class="separator:a5ccf38dfbeefac7e923ad12000683d24"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0b61258a34def41e1db06ff0d8f7b24b"><td class="memItemLeft" align="right" valign="top">tuple&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceellipse__convergence.html#a0b61258a34def41e1db06ff0d8f7b24b">ellipse_convergence.zz</a> = testf.vector()</td></tr>
<tr class="separator:a0b61258a34def41e1db06ff0d8f7b24b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5e988e0763af9cdc6e16c65d1c2c8f22"><td class="memItemLeft" align="right" valign="top">tuple&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceellipse__convergence.html#a5e988e0763af9cdc6e16c65d1c2c8f22">ellipse_convergence.hh</a> = tricontourf(mesh.coordinates()[:,0],mesh.coordinates()[:,1],mesh.cells(),zz,100,cmap=get_cmap('binary'))</td></tr>
<tr class="separator:a5e988e0763af9cdc6e16c65d1c2c8f22"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5d8c2f14e2a0dca929f644347a2bd4fd"><td class="memItemLeft" align="right" valign="top">tuple&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceellipse__convergence.html#a5d8c2f14e2a0dca929f644347a2bd4fd">ellipse_convergence.fid</a> = open(&quot;DOFS_L2errors_CG&quot;+str(CGorder)+outname+&quot;.mpy&quot;,'w')</td></tr>
<tr class="separator:a5d8c2f14e2a0dca929f644347a2bd4fd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae9945195d49d41480fd0f493be9a89cc"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceellipse__convergence.html#ae9945195d49d41480fd0f493be9a89cc">ellipse_convergence.NfitP</a> = 9</td></tr>
<tr class="separator:ae9945195d49d41480fd0f493be9a89cc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4799a27ec091b486d4b76f687111fed1"><td class="memItemLeft" align="right" valign="top">tuple&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceellipse__convergence.html#a4799a27ec091b486d4b76f687111fed1">ellipse_convergence.I</a> = array(range(len(dofs)-NfitP,len(dofs)))</td></tr>
<tr class="separator:a4799a27ec091b486d4b76f687111fed1"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Mon Feb 23 2015 22:50:44 for PRAgMaTIc by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.7
</small></address>
</body>
</html>
